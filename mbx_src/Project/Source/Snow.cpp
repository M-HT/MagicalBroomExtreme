/* encoding = CP932 */
//======================================================================================
//======================================================================================
//
//
//			雪
//
//
//======================================================================================
//======================================================================================


//======================================================================================
//	include
//======================================================================================
#include "Snow.h"

//======================================================================================
//
//		コンストラクタ
//
//======================================================================================
CSNOW::CSNOW( float x, float y, float scale, float angle ) : CSPRITE( SORT_NULL )
{
	Px = x;
	Py = y;
	x1 = LunaMath::CosF( angle ) * scale * 20;
	y1 = LunaMath::SinF( angle ) * scale * 20;
	Scale = (long)(scale * 32);
	Priority = RAND(0,8);
	if ( Priority == 6 ) Priority = 5;
}

//======================================================================================
//
//		処理
//
//======================================================================================
bool CSNOW::Action( void )
{
	Px += x1;
	Py += y1;
	// 画面外
	if ( Px < -30 || Py > 430 )
	{
		// 適当なＸ位置に移動
		Px = F(RAND(0,1200));
		Py = -30;
		// 右過ぎるときは
		if ( Px > 650 )
		{
			// 適当なＹ位置に移動
			Px = 680;
			Py = F(RAND(0,400));
		}
	}

	RECT dest = { (long)(Px-Scale), (long)(Py-Scale), (long)(Px+Scale), (long)(Py+Scale) };
	RECT src = { 736, 478, 768, 510 };
	Sprite[Priority][1]->Draw( &dest, D3DCOLOR_XRGB(96,64,128), &src );

	return bDeath;
}